<div class="span12">
  <div class="sheet pull-right">
    <%= link_to("New Sheet", new_user_sheet_path(@user) , :class => "btn btn-mini btn-primary")%>
    &nbsp;
  </div>
  <h3> <%= "\'#{@user.email}\' -> sheet id = \'#{@sheet.id}\'" %> </h3>
  <div class="span12">
    <pre> <%= @sheet.content %> </pre>
      <div>
        <%= link_to("Edit", edit_user_sheet_path(@sheet.user, @sheet),
          :class => "btn btnbtn-mini btn-primary") %>
        <%= link_to("Delete", user_sheet_path(@sheet.user, @sheet),
          :class   => "btn btnbtn-mini btn-warning",
          :method  => :delete,
          :confirm => "Areyousure?") %>
      </div>
  </div>

  <h3> Study handsontable by FAKE data </h3>

  <%= javascript_include_tag "application" %>
  <%= javascript_include_tag "jquery.handsontable.full" %>
  <%= stylesheet_link_tag    "jquery.handsontable.full" %>

  <input id="search_field" type="text" placeholder="Search"> </input>
  <div id="dataTable", class="handsontable"> </div>
  <script type="text/javascript">
    var data = [
      ["", "Kia", "Nissan", "Toyota", "Honda"],
      ["2008", 10, 11, 12, 13],
      ["2009", 20, 11, 14, 13],
      ["2010", 30, 15, 12, 13]
      ];
    var dataTable = $("#dataTable");

    dataTable.handsontable({
      data: data,
      startRows: 6,
      startCols: 8,
      rowHeaders: true,
      colHeaders: true,
      manualColumnMove: true,
      manualColumnResize: true,
      contextMenu: true,
      currentRowClassName: 'currentRow',
      currentColClassName: 'currentCol',
      persistentState: true,
    });

    $('#search_field').on('keyup', function (event) {
      var value = ('' + this.value).toLowerCase(), row, col, r_len, c_len, td;

      if (value) {
        for (row = 0, r_len = data.length; row < r_len; row++) {
          for (col = 0, c_len = data[row].length; col < c_len; col++) {
            td = dataTable.handsontable('getCell', row, col);

            if (('' + data[row][col]).toLowerCase().indexOf(value) > -1) {
              td.className = 'pass'
            }
            else {
              td.className = '';
            }
          }
        }
      }
    });
  </script>
</div>
